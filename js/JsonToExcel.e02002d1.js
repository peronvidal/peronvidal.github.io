(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["JsonToExcel"],{"169a":function(e,t,i){"use strict";i("368e");var n=i("480e"),o=i("4ad4"),a=i("b848"),r=i("75eb"),s=i("e707"),l=i("e4d3"),c=i("21be"),d=i("f2e7"),u=i("a293"),h=i("58df"),f=i("d9bd"),p=i("80d2");const v=Object(h["a"])(o["a"],a["a"],r["a"],s["a"],l["a"],c["a"],d["a"]);t["a"]=v.extend({name:"v-dialog",directives:{ClickOutside:u["a"]},props:{dark:Boolean,disabled:Boolean,fullscreen:Boolean,light:Boolean,maxWidth:{type:[String,Number],default:"none"},noClickAnimation:Boolean,origin:{type:String,default:"center center"},persistent:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,transition:{type:[String,Boolean],default:"dialog-transition"},width:{type:[String,Number],default:"auto"}},data(){return{activatedBy:null,animate:!1,animateTimeout:-1,isActive:!!this.value,stackMinZIndex:200,previousActiveElement:null}},computed:{classes(){return{[("v-dialog "+this.contentClass).trim()]:!0,"v-dialog--active":this.isActive,"v-dialog--persistent":this.persistent,"v-dialog--fullscreen":this.fullscreen,"v-dialog--scrollable":this.scrollable,"v-dialog--animated":this.animate}},contentClasses(){return{"v-dialog__content":!0,"v-dialog__content--active":this.isActive}},hasActivator(){return Boolean(!!this.$slots.activator||!!this.$scopedSlots.activator)}},watch:{isActive(e){var t;e?(this.show(),this.hideScroll()):(this.removeOverlay(),this.unbind(),null==(t=this.previousActiveElement)||t.focus())},fullscreen(e){this.isActive&&(e?(this.hideScroll(),this.removeOverlay(!1)):(this.showScroll(),this.genOverlay()))}},created(){this.$attrs.hasOwnProperty("full-width")&&Object(f["e"])("full-width",this)},beforeMount(){this.$nextTick(()=>{this.isBooted=this.isActive,this.isActive&&this.show()})},beforeDestroy(){"undefined"!==typeof window&&this.unbind()},methods:{animateClick(){this.animate=!1,this.$nextTick(()=>{this.animate=!0,window.clearTimeout(this.animateTimeout),this.animateTimeout=window.setTimeout(()=>this.animate=!1,150)})},closeConditional(e){const t=e.target;return!(this._isDestroyed||!this.isActive||this.$refs.content.contains(t)||this.overlay&&t&&!this.overlay.$el.contains(t))&&this.activeZIndex>=this.getMaxZIndex()},hideScroll(){this.fullscreen?document.documentElement.classList.add("overflow-y-hidden"):s["a"].options.methods.hideScroll.call(this)},show(){!this.fullscreen&&!this.hideOverlay&&this.genOverlay(),this.$nextTick(()=>{this.$nextTick(()=>{this.previousActiveElement=document.activeElement,this.$refs.content.focus(),this.bind()})})},bind(){window.addEventListener("focusin",this.onFocusin)},unbind(){window.removeEventListener("focusin",this.onFocusin)},onClickOutside(e){this.$emit("click:outside",e),this.persistent?this.noClickAnimation||this.animateClick():this.isActive=!1},onKeydown(e){if(e.keyCode===p["x"].esc&&!this.getOpenDependents().length)if(this.persistent)this.noClickAnimation||this.animateClick();else{this.isActive=!1;const e=this.getActivator();this.$nextTick(()=>e&&e.focus())}this.$emit("keydown",e)},onFocusin(e){if(!e||!this.retainFocus)return;const t=e.target;if(t&&![document,this.$refs.content].includes(t)&&!this.$refs.content.contains(t)&&this.activeZIndex>=this.getMaxZIndex()&&!this.getOpenDependentElements().some(e=>e.contains(t))){const e=this.$refs.content.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),t=[...e].find(e=>!e.hasAttribute("disabled"));t&&t.focus()}},genContent(){return this.showLazyContent(()=>[this.$createElement(n["a"],{props:{root:!0,light:this.light,dark:this.dark}},[this.$createElement("div",{class:this.contentClasses,attrs:{role:"document",tabindex:this.isActive?0:void 0,...this.getScopeIdAttrs()},on:{keydown:this.onKeydown},style:{zIndex:this.activeZIndex},ref:"content"},[this.genTransition()])])])},genTransition(){const e=this.genInnerContent();return this.transition?this.$createElement("transition",{props:{name:this.transition,origin:this.origin,appear:!0}},[e]):e},genInnerContent(){const e={class:this.classes,ref:"dialog",directives:[{name:"click-outside",value:{handler:this.onClickOutside,closeConditional:this.closeConditional,include:this.getOpenDependentElements}},{name:"show",value:this.isActive}],style:{transformOrigin:this.origin}};return this.fullscreen||(e.style={...e.style,maxWidth:"none"===this.maxWidth?void 0:Object(p["g"])(this.maxWidth),width:"auto"===this.width?void 0:Object(p["g"])(this.width)}),this.$createElement("div",e,this.getContentSlot())}},render(e){return e("div",{staticClass:"v-dialog__container",class:{"v-dialog__container--attached":""===this.attach||!0===this.attach||"attach"===this.attach},attrs:{role:"dialog"}},[this.genActivator(),this.genContent()])}})},"1abc":function(e,t,i){"use strict";var n=i("a797");t["a"]=n["a"]},"2fa4":function(e,t,i){"use strict";i("20f6");var n=i("80d2");t["a"]=Object(n["i"])("spacer","div","v-spacer")},"368e":function(e,t,i){},"3c93":function(e,t,i){},a797:function(e,t,i){"use strict";i("3c93");var n=i("a9ad"),o=i("7560"),a=i("f2e7"),r=i("58df");t["a"]=Object(r["a"])(n["a"],o["a"],a["a"]).extend({name:"v-overlay",props:{absolute:Boolean,color:{type:String,default:"#212121"},dark:{type:Boolean,default:!0},opacity:{type:[Number,String],default:.46},value:{default:!0},zIndex:{type:[Number,String],default:5}},computed:{__scrim(){const e=this.setBackgroundColor(this.color,{staticClass:"v-overlay__scrim",style:{opacity:this.computedOpacity}});return this.$createElement("div",e)},classes(){return{"v-overlay--absolute":this.absolute,"v-overlay--active":this.isActive,...this.themeClasses}},computedOpacity(){return Number(this.isActive?this.opacity:0)},styles(){return{zIndex:this.zIndex}}},methods:{genContent(){return this.$createElement("div",{staticClass:"v-overlay__content"},this.$slots.default)}},render(e){const t=[this.__scrim];return this.isActive&&t.push(this.genContent()),e("div",{staticClass:"v-overlay",class:this.classes,style:this.styles},t)}})},be2c:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-dialog",{attrs:{persistent:""},model:{value:e.jsonToExcel,callback:function(t){e.jsonToExcel=t},expression:"jsonToExcel"}},[i("v-card",{staticClass:"pa-5"},[i("v-card-title",[e._v(" Informe de Becas "),i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:e.dark?"grey":"black",small:"",fab:"",right:""},on:{click:e.togleJsonToExcel}},[i("v-icon",{attrs:{color:e.dark?"black":"white"}},[e._v(" mdi-close ")])],1)],1),i("v-card-text",[i("v-select",{attrs:{chips:"","deletable-chips":"",multiple:"",items:e.convocatorias,label:"Seleccione las convocatorias que desea incluir"},scopedSlots:e._u([{key:"prepend-item",fn:function(){return[i("v-list-item",{attrs:{ripple:""},on:{click:function(t){return e.togle(e.convocatoriaSelected,"convocatoriaSelected",e.convocatorias)}}},[i("v-list-item-action",[i("v-icon",{attrs:{color:e.convocatoriaSelected>0?"indigo darken-4":""}},[e._v(" "+e._s(e.iconConvocatoria)+" ")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v(" "+e._s(e.selectAllTextConvocatorias)+" ")])],1)],1),i("v-divider",{staticClass:"mt-2"})]},proxy:!0}]),model:{value:e.convocatoriaSelected,callback:function(t){e.convocatoriaSelected=t},expression:"convocatoriaSelected"}}),i("v-select",{attrs:{chips:"","deletable-chips":"",multiple:"",items:["GRADO","DOCTORADO","POSDOCTORADO"],label:"Seleccione el tipo de beca que desea incluir"},model:{value:e.tipoSelected,callback:function(t){e.tipoSelected=t},expression:"tipoSelected"}}),i("v-select",{attrs:{"item-text":"name","item-value":"value",items:e.becaKeys,chips:"","deletable-chips":"",multiple:"",label:"Seleccione los datos que desea incluir"},scopedSlots:e._u([{key:"prepend-item",fn:function(){return[i("v-list-item",{attrs:{ripple:""},on:{click:function(t){return e.togle(e.keySelected,"keySelected",e.becaKeys)}}},[i("v-list-item-action",[i("v-icon",{attrs:{color:e.convocatoriaSelected>0?"indigo darken-4":""}},[e._v(" "+e._s(e.iconBeca)+" ")])],1),i("v-list-item-content",[i("v-list-item-title",[e._v(" "+e._s(e.selectAllTextBeca)+" ")])],1)],1),i("v-divider",{staticClass:"mt-2"})]},proxy:!0}]),model:{value:e.keySelected,callback:function(t){e.keySelected=t},expression:"keySelected"}})],1),i("v-card-actions",[i("v-spacer"),i("download-excel",{attrs:{data:e.becas,worksheet:"My Worksheet",name:"Informe.xls",fields:e.becaFields}},[i("v-btn",{staticClass:"ml-3",attrs:{disabled:0===e.becas.length,text:"",color:"green",outlined:""}},[e._v(" Descargar informe en Excel ")])],1)],1)],1)],1)},o=[],a=(i("4de4"),i("7db0"),i("5db7"),i("caad"),i("d81d"),i("13d5"),i("73d9"),i("b64b"),i("2532"),i("2909")),r=i("ade3"),s=i("5530"),l=i("f2d9"),c=i("2f62"),d={components:{downloadExcel:l["a"]},data:function(){return{convocatoriaSelected:[],tipoSelected:[],keySelected:["cuil","apellido","nombre","convocatoria"],json_meta:[[{key:"charset",value:"utf-8"}]]}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(c["d"])(["curData","curBeca","jsonToExcel","dark"])),Object(c["c"])(["convocatoriasVigentes"])),{},{becaFields:function(){return Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({},this.keySelected.find((function(e){return"nombre"===e}))&&{Nombre:"nombre"}),this.keySelected.find((function(e){return"apellido"===e}))&&{Apellido:"apellido"}),this.keySelected.find((function(e){return"convocatoria"===e}))&&{Convocatoria:"convocatoria"}),this.keySelected.find((function(e){return"expediente"===e}))&&{Expediente:"expediente"}),this.keySelected.find((function(e){return"tipo"===e}))&&{"Tipo de Beca":"tipo"}),this.keySelected.find((function(e){return"fechaIni"===e}))&&{"Fecha de Inicio":"fechaIni"}),this.keySelected.find((function(e){return"fechaFin"===e}))&&{"Fecha de Finalizaci贸n":"fechaFin"}),this.keySelected.find((function(e){return"cuil"===e}))&&{"Cuil del Becario":"cuil"}),this.keySelected.find((function(e){return"nombreDirector"===e}))&&{"Nombre Del Director":"nombreDirector"}),this.keySelected.find((function(e){return"apellidoDirector"===e}))&&{"Apellido del Director":"apellidoDirector"}),this.keySelected.find((function(e){return"cuilDirector"===e}))&&{"CUIL del director":"cuilDirector"}),this.keySelected.find((function(e){return"nombreCodirector"===e}))&&{"Nombre del Codirector":"nombreCodirector"}),this.keySelected.find((function(e){return"apellidoCodirector"===e}))&&{"Apellido del Codirector":"apellidoCodirector"}),this.keySelected.find((function(e){return"cuilCodirector"===e}))&&{"Apellido del Codirector":"apellidoCodirector"}),this.keySelected.find((function(e){return"beca"===e}))&&{"Denominaci贸n de la Beca":"beca"}),this.keySelected.find((function(e){return"planDeTrabajo"===e}))&&{"Plan de trabajo":"planDeTrabajo"}),this.keySelected.find((function(e){return"financiaPosgrado"===e}))&&{"Financia Posgrado":"financiaPosgrado"}),this.keySelected.find((function(e){return"comentario"===e}))&&{Observaciones:"comentario"}),this.keySelected.find((function(e){return"dni"===e}))&&{DNI:"dni"}),this.keySelected.find((function(e){return"unidadBeneficiaria"===e}))&&{unidad:{callback:function(e){return"".concat(e.unidadBeneficiaria[0].unidad)}}})},becaKeys:function(){var e=[{name:"Nombre del Becario",value:"nombre"},{name:"Apellido del Becario",value:"apellido"},{name:"Convocatoria",value:"convocatoria"},{name:"Cuil del Becario",value:"cuil"},{name:"Expediente",value:"expediente"},{name:"Tipo de Beca",value:"tipo"},{name:"Fecha de inicio",value:"fechaIni"},{name:"Fecha de finalizaci贸n",value:"fechaFin"},{name:"Nombre del Director",value:"nombreDirector"},{name:"Apellido del Director",value:"apellidoDirector"},{name:"Cuil del Director",value:"cuilDirector"},{name:"Nombre del Codirector",value:"nombreCodirector"},{name:"Apellido del Codirector",value:"apellidoCodirector"},{name:"Cuil del Codirector",value:"cuilCodirector"},{name:"Denominaci贸n de la Beca",value:"beca"},{name:"Prorroga",value:"prorroga"},{name:"Plan De Trabajo",value:"planDeTrabajo"},{name:"Unidades Financiadoras",value:"financiamiento"},{name:"Unidad Beneficiaria",value:"unidadBeneficiaria"},{name:"Financia Posgrado",value:"financiaPosgrado"},{name:"Observaciones",value:"comentario"},{name:"DNI",value:"dni"},{name:"Baja",value:"estado"}];return e},convocatorias:function(){return this.convocatoriasVigentes},becas:function(){var e=this,t=this.convocatoriaSelected.flatMap((function(t){return e.curData.filter((function(e){return e.convocatoria===t}))})),i=this.tipoSelected.flatMap((function(e){return t.filter((function(t){return t.tipo===e}))})),n=i.map((function(t){var i=e.keySelected,n=Object.keys(t).filter((function(e){return i.includes(e)})).reduce((function(e,i){return Object(s["a"])(Object(s["a"])({},e),{},Object(r["a"])({},i,t[i]))}),{});return n}));return n.sort((function(e,t){return e.convocatoria.localeCompare(t.convocatoria)}))},iconConvocatoria:function(){var e=this.convocatoriaSelected.length===this.convocatoriaSelected,t=this.convocatoriaSelected.length>0&&!e;return e?"mdi-close-box":t?"mdi-minus-box":"mdi-checkbox-blank-outline"},iconBeca:function(){var e=this.tipoSelected.length===this.tipoSelected,t=this.tipoSelected.length>0&&!e;return e?"mdi-close-box":t?"mdi-minus-box":"mdi-checkbox-blank-outline"},selectAllTextConvocatorias:function(){return 0===this.convocatoriaSelected.length?"Seleccionar Todo":"Cancelar"},selectAllTextBeca:function(){return 0===this.keySelected.length?"Seleccionar Todo":"Cancelar"}}),methods:Object(s["a"])(Object(s["a"])({},Object(c["b"])(["togleJsonToExcel"])),{},{togle:function(e,t,i){e.length===i.length||e.length>0?this[t]=[]:this[t]=Object(a["a"])(i)}})},u=d,h=i("2877"),f=i("6544"),p=i.n(f),v=i("8336"),m=i("b0af"),b=i("99d9"),y=i("169a"),g=i("ce7e"),x=i("132d"),w=i("da13"),S=i("1800"),k=i("5d23"),C=i("b974"),O=i("2fa4"),T=Object(h["a"])(u,n,o,!1,null,null,null);t["default"]=T.exports;p()(T,{VBtn:v["a"],VCard:m["a"],VCardActions:b["a"],VCardText:b["c"],VCardTitle:b["d"],VDialog:y["a"],VDivider:g["a"],VIcon:x["a"],VListItem:w["a"],VListItemAction:S["a"],VListItemContent:k["a"],VListItemTitle:k["c"],VSelect:C["a"],VSpacer:O["a"]})},e707:function(e,t,i){"use strict";var n=i("1abc"),o=i("80d2"),a=i("2b0e");t["a"]=a["default"].extend().extend({name:"overlayable",props:{hideOverlay:Boolean,overlayColor:String,overlayOpacity:[Number,String]},data(){return{animationFrame:0,overlay:null}},watch:{hideOverlay(e){this.isActive&&(e?this.removeOverlay():this.genOverlay())}},beforeDestroy(){this.removeOverlay()},methods:{createOverlay(){const e=new n["a"]({propsData:{absolute:this.absolute,value:!1,color:this.overlayColor,opacity:this.overlayOpacity}});e.$mount();const t=this.absolute?this.$el.parentNode:document.querySelector("[data-app]");t&&t.insertBefore(e.$el,t.firstChild),this.overlay=e},genOverlay(){if(this.hideScroll(),!this.hideOverlay)return this.overlay||this.createOverlay(),this.animationFrame=requestAnimationFrame(()=>{this.overlay&&(void 0!==this.activeZIndex?this.overlay.zIndex=String(this.activeZIndex-1):this.$el&&(this.overlay.zIndex=Object(o["u"])(this.$el)),this.overlay.value=!0)}),!0},removeOverlay(e=!0){this.overlay&&(Object(o["a"])(this.overlay.$el,"transitionend",()=>{this.overlay&&this.overlay.$el&&this.overlay.$el.parentNode&&!this.overlay.value&&(this.overlay.$el.parentNode.removeChild(this.overlay.$el),this.overlay.$destroy(),this.overlay=null)}),cancelAnimationFrame(this.animationFrame),this.overlay.value=!1),e&&this.showScroll()},scrollListener(e){if("keydown"===e.type){if(["INPUT","TEXTAREA","SELECT"].includes(e.target.tagName)||e.target.isContentEditable)return;const t=[o["x"].up,o["x"].pageup],i=[o["x"].down,o["x"].pagedown];if(t.includes(e.keyCode))e.deltaY=-1;else{if(!i.includes(e.keyCode))return;e.deltaY=1}}(e.target===this.overlay||"keydown"!==e.type&&e.target===document.body||this.checkPath(e))&&e.preventDefault()},hasScrollbar(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const t=window.getComputedStyle(e);return["auto","scroll"].includes(t.overflowY)&&e.scrollHeight>e.clientHeight},shouldScroll(e,t){return 0===e.scrollTop&&t<0||e.scrollTop+e.clientHeight===e.scrollHeight&&t>0},isInside(e,t){return e===t||null!==e&&e!==document.body&&this.isInside(e.parentNode,t)},checkPath(e){const t=e.path||this.composedPath(e),i=e.deltaY;if("keydown"===e.type&&t[0]===document.body){const e=this.$refs.dialog,t=window.getSelection().anchorNode;return!(e&&this.hasScrollbar(e)&&this.isInside(t,e))||this.shouldScroll(e,i)}for(let n=0;n<t.length;n++){const e=t[n];if(e===document)return!0;if(e===document.documentElement)return!0;if(e===this.$refs.content)return!0;if(this.hasScrollbar(e))return this.shouldScroll(e,i)}return!0},composedPath(e){if(e.composedPath)return e.composedPath();const t=[];let i=e.target;while(i){if(t.push(i),"HTML"===i.tagName)return t.push(document),t.push(window),t;i=i.parentElement}return t},hideScroll(){this.$vuetify.breakpoint.smAndDown?document.documentElement.classList.add("overflow-y-hidden"):(Object(o["b"])(window,"wheel",this.scrollListener,{passive:!1}),window.addEventListener("keydown",this.scrollListener))},showScroll(){document.documentElement.classList.remove("overflow-y-hidden"),window.removeEventListener("wheel",this.scrollListener),window.removeEventListener("keydown",this.scrollListener)}}})},f2d9:function(e,t,i){"use strict";(function(e){"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof e||"undefined"!==typeof self&&self;function i(e,t){return t={exports:{}},e(t,t.exports),t.exports}var n=i((function(e,t){(function(t,i){e.exports=i()})(0,(function(){return function e(t,i,n){var o,a,r=window,s="application/octet-stream",l=n||s,c=t,d=!i&&!n&&c,u=document.createElement("a"),h=function(e){return String(e)},f=r.Blob||r.MozBlob||r.WebKitBlob||h,p=i||"download";if(f=f.call?f.bind(r):Blob,"true"===String(this)&&(c=[c,l],l=c[0],c=c[1]),d&&d.length<2048&&(p=d.split("/").pop().split("?")[0],u.href=d,-1!==u.href.indexOf(d))){var v=new XMLHttpRequest;return v.open("GET",d,!0),v.responseType="blob",v.onload=function(t){e(t.target.response,p,s)},setTimeout((function(){v.send()}),0),v}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(c)){if(!(c.length>2096103.424&&f!==h))return navigator.msSaveBlob?navigator.msSaveBlob(g(c),p):x(c);c=g(c),l=c.type||s}else if(/([\x80-\xff])/.test(c)){var m=0,b=new Uint8Array(c.length),y=b.length;for(m;m<y;++m)b[m]=c.charCodeAt(m);c=new f([b],{type:l})}function g(e){var t=e.split(/[:;,]/),i=t[1],n="base64"==t[2]?atob:decodeURIComponent,o=n(t.pop()),a=o.length,r=0,s=new Uint8Array(a);for(r;r<a;++r)s[r]=o.charCodeAt(r);return new f([s],{type:i})}function x(e,t){if("download"in u)return u.href=e,u.setAttribute("download",p),u.className="download-js-link",u.innerHTML="downloading...",u.style.display="none",document.body.appendChild(u),setTimeout((function(){u.click(),document.body.removeChild(u),!0===t&&setTimeout((function(){r.URL.revokeObjectURL(u.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var i=document.createElement("iframe");document.body.appendChild(i),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),i.src=e,setTimeout((function(){document.body.removeChild(i)}),333)}if(o=c instanceof f?c:new f([c],{type:l}),navigator.msSaveBlob)return navigator.msSaveBlob(o,p);if(r.URL)x(r.URL.createObjectURL(o),!0);else{if("string"===typeof o||o.constructor===h)try{return x("data:"+l+";base64,"+r.btoa(o))}catch(w){return x("data:"+l+","+encodeURIComponent(o))}a=new FileReader,a.onload=function(e){x(this.result)},a.readAsDataURL(o)}return!0}}))})),o={props:{type:{type:String,default:"xls"},data:{type:Array,required:!1,default:null},fields:{type:Object,default:()=>null},exportFields:{type:Object,default:()=>null},defaultValue:{type:String,required:!1,default:""},header:{default:null},footer:{default:null},name:{type:String,default:"data.xls"},fetch:{type:Function},meta:{type:Array,default:()=>[]},worksheet:{type:String,default:"Sheet1"},beforeGenerate:{type:Function},beforeFinish:{type:Function},escapeCsv:{type:Boolean,default:!0},stringifyLongNum:{type:Boolean,default:!1}},computed:{idName(){var e=(new Date).getTime();return"export_"+e},downloadFields(){return this.fields?this.fields:this.exportFields?this.exportFields:void 0}},methods:{async generate(){"function"===typeof this.beforeGenerate&&await this.beforeGenerate();let e=this.data;if("function"!==typeof this.fetch&&e||(e=await this.fetch()),!e||!e.length)return;let t=this.getProcessedJson(e,this.downloadFields);return"html"===this.type?this.export(this.jsonToXLS(t),this.name.replace(".xls",".html"),"text/html"):"csv"===this.type?this.export(this.jsonToCSV(t),this.name.replace(".xls",".csv"),"application/csv"):this.export(this.jsonToXLS(t),this.name,"application/vnd.ms-excel")},export:async function(e,t,i){let o=this.base64ToBlob(e,i);"function"===typeof this.beforeFinish&&await this.beforeFinish(),n(o,t,i)},jsonToXLS(e){let t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>${worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>br {mso-data-placement: same-cell;}</style></head><body><table>${table}</table></body></html>',i="<thead>";const n=Object.keys(e[0]).length;let o=this;const a=this.header||this.$attrs.title;a&&(i+=this.parseExtraData(a,'<tr><th colspan="'+n+'">${data}</th></tr>')),i+="<tr>";for(let r in e[0])i+="<th>"+r+"</th>";return i+="</tr>",i+="</thead>",i+="<tbody>",e.map((function(e,t){i+="<tr>";for(let n in e)i+="<td>"+o.preprocessLongNum(o.valueReformattedForMultilines(e[n]))+"</td>";i+="</tr>"})),i+="</tbody>",null!=this.footer&&(i+="<tfoot>",i+=this.parseExtraData(this.footer,'<tr><td colspan="'+n+'">${data}</td></tr>'),i+="</tfoot>"),t.replace("${table}",i).replace("${worksheet}",this.worksheet)},jsonToCSV(e){let t=this;var i=[];const n=this.header||this.$attrs.title;n&&i.push(this.parseExtraData(n,"${data}\r\n"));for(let o in e[0])i.push(o),i.push(",");return i.pop(),i.push("\r\n"),e.map((function(e){for(let n in e){let o=e[n]+"";t.escapeCsv&&(o='="'+o+'"',o.match(/[,"\n]/)&&(o='"'+o.replace(/\"/g,'""')+'"')),i.push(o),i.push(",")}i.pop(),i.push("\r\n")})),null!=this.footer&&i.push(this.parseExtraData(this.footer,"${data}\r\n")),i.join("")},getProcessedJson(e,t){let i=this.getKeys(e,t),n=[],o=this;return e.map((function(e,t){let a={};for(let n in i){let t=i[n];a[n]=o.getValue(t,e)}n.push(a)})),n},getKeys(e,t){if(t)return t;let i={};for(let n in e[0])i[n]=n;return i},parseExtraData(e,t){let i="";if(Array.isArray(e))for(var n=0;n<e.length;n++)e[n]&&(i+=t.replace("${data}",e[n]));else i+=t.replace("${data}",e);return i},getValue(e,t){const i="object"!==typeof e?e:e.field;let n="string"!==typeof i?[]:i.split("."),o=this.defaultValue;return o=i?n.length>1?this.getValueFromNestedItem(t,n):this.parseValue(t[i]):t,e.hasOwnProperty("callback")&&(o=this.getValueFromCallback(o,e.callback)),o},valueReformattedForMultilines(e){return"string"==typeof e?e.replace(/\n/gi,"<br/>"):e},preprocessLongNum(e){if(this.stringifyLongNum){if(String(e).startsWith("0x"))return e;if(!isNaN(e)&&""!=e&&(e>99999999999||e<1e-13))return'="'+e+'"'}return e},getValueFromNestedItem(e,t){let i=e;for(let n of t)i&&(i=i[n]);return this.parseValue(i)},getValueFromCallback(e,t){if("function"!==typeof t)return this.defaultValue;const i=t(e);return this.parseValue(i)},parseValue(e){return e||0===e||"boolean"===typeof e?e:this.defaultValue},base64ToBlob(e,t){let i=window.btoa(window.unescape(encodeURIComponent(e))),n=atob(i),o=n.length,a=new Uint8ClampedArray(o);while(o--)a[o]=n.charCodeAt(o);return new Blob([a],{type:t})}}};function a(e,t,i,n,o,a,r,s,l,c){"boolean"!==typeof r&&(l=s,s=r,r=!1);var d,u="function"===typeof i?i.options:i;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,o&&(u.functional=!0)),n&&(u._scopeId=n),a?(d=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=d):t&&(d=r?function(){t.call(this,c(this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),d)if(u.functional){var h=u.render;u.render=function(e,t){return d.call(t),h(e,t)}}else{var f=u.beforeCreate;u.beforeCreate=f?[].concat(f,d):[d]}return i}var r=a;const s=o;var l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:e.idName},on:{click:e.generate}},[e._t("default",[e._v(" Download "+e._s(e.name)+" ")])],2)},c=[];l._withStripped=!0;const d=void 0,u=void 0,h=void 0,f=!1;var p=r({render:l,staticRenderFns:c},d,s,u,f,h,void 0,void 0);t["a"]=p}).call(this,i("c8ba"))}}]);